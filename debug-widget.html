<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Fashion Widget</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f4;
        }
        .debug-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }
        .debug-title {
            text-align: center;
            color: #292524;
            margin-bottom: 30px;
        }
        .debug-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #fafaf9;
            border-radius: 8px;
            border: 1px solid #e7e5e4;
        }
        .debug-button {
            background: #059669;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px;
            transition: background 0.2s ease;
        }
        .debug-button:hover {
            background: #047857;
        }
        .debug-button.secondary {
            background: #6b7280;
        }
        .debug-button.secondary:hover {
            background: #4b5563;
        }
        .debug-button.danger {
            background: #dc2626;
        }
        .debug-button.danger:hover {
            background: #b91c1c;
        }
        .debug-log {
            background: #1f2937;
            color: #f9fafb;
            padding: 16px;
            border-radius: 8px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .status-success { background: #10b981; }
        .status-error { background: #ef4444; }
        .status-warning { background: #f59e0b; }
        .status-info { background: #3b82f6; }
    </style>
</head>
<body>
    <div class="debug-container">
        <h1 class="debug-title">üêõ Debug Fashion Widget</h1>
        
        <div class="debug-section">
            <h2>Widget Control</h2>
            <p>Use these buttons to manually control the widget for testing:</p>
            
            <div style="text-align: center;">
                <button class="debug-button" onclick="testWidget()">üöÄ Test Widget</button>
                <button class="debug-button secondary" onclick="showWidget()">üëÅÔ∏è Show Widget</button>
                <button class="debug-button secondary" onclick="hideWidget()">üôà Hide Widget</button>
                <button class="debug-button secondary" onclick="expandWidget()">üìñ Expand Widget</button>
                <button class="debug-button secondary" onclick="collapseWidget()">üì± Collapse Widget</button>
                <button class="debug-button danger" onclick="resetWidget()">üîÑ Reset Widget</button>
            </div>
        </div>
        
        <div class="debug-section">
            <h2>Widget Status</h2>
            <div id="widget-status">
                <p><span class="status-indicator status-info"></span>Widget status will appear here...</p>
            </div>
        </div>
        
        <div class="debug-section">
            <h2>Console Log</h2>
            <p>Recent console messages from the widget:</p>
            <div id="console-log" class="debug-log">Waiting for widget logs...</div>
        </div>
        
        <div class="debug-section">
            <h2>Debug Information</h2>
            <div id="debug-info">
                <p><strong>Page URL:</strong> <span id="page-url"></span></p>
                <p><strong>Page Title:</strong> <span id="page-title"></span></p>
                <p><strong>Widget Element:</strong> <span id="widget-element"></span></p>
                <p><strong>Widget Visible:</strong> <span id="widget-visible"></span></p>
                <p><strong>Widget Expanded:</strong> <span id="widget-expanded"></span></p>
            </div>
        </div>
        
        <div class="debug-section">
            <h2>Manual Brand Detection</h2>
            <p>Test brand detection with custom input:</p>
            <input type="text" id="brand-input" placeholder="Enter brand name" style="padding: 8px; margin-right: 10px; border: 1px solid #d1d5db; border-radius: 4px;">
            <button class="debug-button secondary" onclick="testBrandDetection()">üîç Test Brand</button>
        </div>
    </div>

    <script>
        // Store console logs
        const consoleLogs = [];
        const maxLogs = 50;
        
        // Override console methods to capture logs
        const originalLog = console.log;
        const originalError = console.error;
        const originalWarn = console.warn;
        const originalInfo = console.info;
        
        function addLog(level, ...args) {
            const timestamp = new Date().toLocaleTimeString();
            const message = args.map(arg => 
                typeof arg === 'object' ? JSON.stringify(arg, null, 2) : String(arg)
            ).join(' ');
            
            consoleLogs.push(`[${timestamp}] ${level.toUpperCase()}: ${message}`);
            
            if (consoleLogs.length > maxLogs) {
                consoleLogs.shift();
            }
            
            updateConsoleLog();
        }
        
        console.log = (...args) => {
            addLog('log', ...args);
            originalLog.apply(console, args);
        };
        
        console.error = (...args) => {
            addLog('error', ...args);
            originalError.apply(console, args);
        };
        
        console.warn = (...args) => {
            addLog('warn', ...args);
            originalWarn.apply(console, args);
        };
        
        console.info = (...args) => {
            addLog('info', ...args);
            originalInfo.apply(console, args);
        };
        
        function updateConsoleLog() {
            const logElement = document.getElementById('console-log');
            logElement.textContent = consoleLogs.join('\n');
            logElement.scrollTop = logElement.scrollHeight;
        }
        
        function updateDebugInfo() {
            document.getElementById('page-url').textContent = window.location.href;
            document.getElementById('page-title').textContent = document.title;
            
            const widget = window.testFashionWidget?.widget;
            if (widget) {
                document.getElementById('widget-element').textContent = 'Found';
                document.getElementById('widget-visible').textContent = widget.style.opacity === '1' ? 'Yes' : 'No';
                document.getElementById('widget-expanded').textContent = widget.classList.contains('expanded') ? 'Yes' : 'No';
            } else {
                document.getElementById('widget-element').textContent = 'Not found';
                document.getElementById('widget-visible').textContent = 'N/A';
                document.getElementById('widget-expanded').textContent = 'N/A';
            }
        }
        
        function updateWidgetStatus(message, type = 'info') {
            const statusElement = document.getElementById('widget-status');
            const statusClass = `status-${type}`;
            statusElement.innerHTML = `<p><span class="status-indicator ${statusClass}"></span>${message}</p>`;
        }
        
        // Widget control functions
        function testWidget() {
            console.log('üß™ Testing widget...');
            updateWidgetStatus('Testing widget...', 'info');
            
            if (window.testFashionWidget) {
                window.testFashionWidget.show();
                updateWidgetStatus('Widget test completed!', 'success');
            } else {
                updateWidgetStatus('Widget not available. Check console for errors.', 'error');
            }
            
            updateDebugInfo();
        }
        
        function showWidget() {
            if (window.testFashionWidget) {
                window.testFashionWidget.show();
                updateWidgetStatus('Widget shown', 'success');
            } else {
                updateWidgetStatus('Widget not available', 'error');
            }
            updateDebugInfo();
        }
        
        function hideWidget() {
            if (window.testFashionWidget) {
                window.testFashionWidget.hide();
                updateWidgetStatus('Widget hidden', 'success');
            } else {
                updateWidgetStatus('Widget not available', 'error');
            }
            updateDebugInfo();
        }
        
        function expandWidget() {
            if (window.testFashionWidget) {
                window.testFashionWidget.expand();
                updateWidgetStatus('Widget expanded', 'success');
            } else {
                updateWidgetStatus('Widget not available', 'error');
            }
            updateDebugInfo();
        }
        
        function collapseWidget() {
            if (window.testFashionWidget) {
                window.testFashionWidget.collapse();
                updateWidgetStatus('Widget collapsed', 'success');
            } else {
                updateWidgetStatus('Widget not available', 'error');
            }
            updateDebugInfo();
        }
        
        function resetWidget() {
            if (window.testFashionWidget) {
                // Force recreate widget
                window.testFashionWidget.show();
                updateWidgetStatus('Widget reset', 'success');
            } else {
                updateWidgetStatus('Widget not available', 'error');
            }
            updateDebugInfo();
        }
        
        function testBrandDetection() {
            const brandInput = document.getElementById('brand-input');
            const brandName = brandInput.value.trim();
            
            if (brandName) {
                console.log('üîç Testing brand detection for:', brandName);
                updateWidgetStatus(`Testing brand detection for: ${brandName}`, 'info');
                
                // Simulate brand detection
                if (window.testFashionWidget) {
                    window.testFashionWidget.show();
                    updateWidgetStatus(`Brand detection test for: ${brandName}`, 'success');
                }
            } else {
                updateWidgetStatus('Please enter a brand name', 'warning');
            }
        }
        
        // Update debug info periodically
        setInterval(updateDebugInfo, 1000);
        
        // Initial update
        updateDebugInfo();
        
        // Log page load
        console.log('üêõ Debug page loaded');
        console.log('üéØ Waiting for FashionWidget to initialize...');
        
        // Check for widget every second
        const widgetCheckInterval = setInterval(() => {
            if (window.testFashionWidget) {
                console.log('üéØ FashionWidget found and ready for testing!');
                updateWidgetStatus('FashionWidget ready for testing!', 'success');
                clearInterval(widgetCheckInterval);
            }
        }, 1000);
    </script>
</body>
</html>
