<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Current Detection System</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .debug-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        .status {
            font-weight: bold;
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
        }
        .status.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .status.warning {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        .code-block {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .test-button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background-color: #0056b3;
        }
        .results {
            margin-top: 20px;
            padding: 15px;
            background-color: #e9ecef;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <h1>üêõ Debug Current Detection System</h1>
    <p>This page helps debug why the widget might not be appearing on fashion websites.</p>

    <div class="debug-section">
        <h2>üîç Current Detection Status</h2>
        <div id="detection-status" class="status warning">
            Detection system not yet tested...
        </div>
        
        <button class="test-button" onclick="testDetection()">Test Detection System</button>
        <button class="test-button" onclick="checkExtension()">Check Extension Status</button>
        <button class="test-button" onclick="simulateFashionSite()">Simulate Fashion Site</button>
        
        <div id="test-results" class="results" style="display: none;">
            <h3>Test Results:</h3>
            <div id="results-content"></div>
        </div>
    </div>

    <div class="debug-section">
        <h2>üìã Manual Debug Steps</h2>
        <ol>
            <li><strong>Open Developer Tools</strong> (F12 or right-click ‚Üí Inspect)</li>
            <li><strong>Go to Console tab</strong></li>
            <li><strong>Look for messages</strong> starting with üéØ FashionWidget:</li>
            <li><strong>Check for errors</strong> in red</li>
            <li><strong>Test on actual fashion sites</strong> like zara.com, hm.com</li>
        </ol>
    </div>

    <div class="debug-section">
        <h2>üß™ Expected Console Messages</h2>
        <div class="code-block">üéØ FashionWidget: Starting detection process...
üéØ FashionWidget: Current URL: [current URL]
üéØ FashionWidget: Current hostname: [hostname]
üéØ FashionWidget: Page title: [page title]

// Then one of these outcomes:
‚úÖ SUCCESS: Widget should appear
üéØ FashionWidget: Confirmed fashion domain detected: [hostname]
üéØ FashionWidget: Site looks like a fashion retailer, showing widget

‚ùå BLOCKED: Widget hidden
üéØ FashionWidget: Non-fashion site detected, skipping completely
üéØ FashionWidget: Publishing platform detected, skipping widget
üéØ FashionWidget: General e-commerce platform detected, skipping widget
üéØ FashionWidget: Site does not appear to be a fashion retailer, skipping widget</div>
    </div>

    <div class="debug-section">
        <h2>üö® Common Issues</h2>
        <ul>
            <li><strong>No console messages:</strong> Extension not running or not loaded</li>
            <li><strong>"Non-fashion site detected":</strong> Site blocked by detection system</li>
            <li><strong>"Site does not appear to be a fashion retailer":</strong> Smart detection failed</li>
            <li><strong>Widget created but not visible:</strong> CSS/styling issues</li>
        </ul>
    </div>

    <div class="debug-section">
        <h2>üîß Quick Fixes</h2>
        <ol>
            <li><strong>Reload extension:</strong> Go to chrome://extensions/ ‚Üí reload</li>
            <li><strong>Hard refresh page:</strong> Ctrl+Shift+R</li>
            <li><strong>Check permissions:</strong> Verify extension has access to current site</li>
            <li><strong>Disable ad blockers:</strong> Temporarily disable to test</li>
        </ol>
    </div>

    <script>
        // Debug functions
        function testDetection() {
            const resultsDiv = document.getElementById('test-results');
            const resultsContent = document.getElementById('results-content');
            const statusDiv = document.getElementById('detection-status');
            
            resultsDiv.style.display = 'block';
            resultsContent.innerHTML = '<p>Running detection tests...</p>';
            
            // Test current page detection
            const currentUrl = window.location.href;
            const currentHostname = window.location.hostname;
            const currentTitle = document.title;
            
            let results = '<h4>Current Page Analysis:</h4>';
            results += `<p><strong>URL:</strong> ${currentUrl}</p>`;
            results += `<p><strong>Hostname:</strong> ${currentHostname}</p>`;
            results += `<p><strong>Title:</strong> ${currentTitle}</p>`;
            
            // Check if this looks like a fashion site
            const fashionKeywords = ['fashion', 'clothing', 'style', 'shop', 'store', 'boutique', 'wear'];
            const hasFashionKeywords = fashionKeywords.some(keyword => 
                currentUrl.toLowerCase().includes(keyword) || 
                currentTitle.toLowerCase().includes(keyword)
            );
            
            results += `<p><strong>Fashion Keywords Found:</strong> ${hasFashionKeywords ? 'Yes' : 'No'}</p>`;
            
            // Check for e-commerce patterns
            const hasEcommercePatterns = 
                document.querySelector('[class*="cart"], [class*="Cart"]') ||
                document.querySelector('[class*="product"], [class*="Product"]') ||
                document.querySelector('[class*="price"], [class*="Price"]');
            
            results += `<p><strong>E-commerce Patterns:</strong> ${hasEcommercePatterns ? 'Yes' : 'No'}</p>`;
            
            // Check if widget should appear
            if (hasFashionKeywords || hasEcommercePatterns) {
                results += '<p class="status success">‚úÖ This page SHOULD show the widget (if detection is working)</p>';
                statusDiv.className = 'status success';
                statusDiv.textContent = '‚úÖ Page appears to be fashion-related - widget should appear';
            } else {
                results += '<p class="status warning">‚ö†Ô∏è This page may not be fashion-related</p>';
                statusDiv.className = 'status warning';
                statusDiv.textContent = '‚ö†Ô∏è Page does not appear to be fashion-related';
            }
            
            resultsContent.innerHTML = results;
        }
        
        function checkExtension() {
            const resultsDiv = document.getElementById('test-results');
            const resultsContent = document.getElementById('results-content');
            
            resultsDiv.style.display = 'block';
            
            let results = '<h4>Extension Status Check:</h4>';
            
            // Check if FashionWidget class exists (would be added by extension)
            if (window.FashionWidget) {
                results += '<p class="status success">‚úÖ FashionWidget class found - extension is running</p>';
            } else {
                results += '<p class="status error">‚ùå FashionWidget class not found - extension may not be running</p>';
            }
            
            // Check if widget HTML exists
            const existingWidget = document.getElementById('fashion-fit-widget');
            if (existingWidget) {
                results += '<p class="status success">‚úÖ Widget HTML found on page</p>';
            } else {
                results += '<p class="status warning">‚ö†Ô∏è No widget HTML found on page</p>';
            }
            
            // Check for extension-related CSS
            const extensionCSS = document.querySelector('link[href*="content-styles.css"]');
            if (extensionCSS) {
                results += '<p class="status success">‚úÖ Extension CSS loaded</p>';
            } else {
                results += '<p class="status warning">‚ö†Ô∏è Extension CSS not found</p>';
            }
            
            resultsContent.innerHTML = results;
        }
        
        function simulateFashionSite() {
            const resultsDiv = document.getElementById('test-results');
            const resultsContent = document.getElementById('results-content');
            
            resultsDiv.style.display = 'block';
            
            // Simulate fashion site content
            const fashionContent = document.createElement('div');
            fashionContent.innerHTML = `
                <h4>Simulated Fashion Site Elements:</h4>
                <div class="product-grid">
                    <div class="product-item">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iI2YwZjBmMCIvPjx0ZXh0IHg9IjUwIiB5PSI1MCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjEyIiBmaWxsPSIjNjY2IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkeT0iLjNlbSI+UHJvZHVjdDwvdGV4dD48L3N2Zz4=" alt="Product">
                        <h3>Fashion Item</h3>
                        <p class="price">$99.99</p>
                        <button class="add-to-cart">Add to Cart</button>
                        <select class="size">
                            <option value="XS">XS</option>
                            <option value="S">S</option>
                            <option value="M">M</option>
                            <option value="L">L</option>
                            <option value="XL">XL</option>
                        </select>
                    </div>
                </div>
            `;
            
            // Add to page
            document.body.appendChild(fashionContent);
            
            resultsContent.innerHTML = `
                <h4>Fashion Site Simulation:</h4>
                <p>‚úÖ Added fashion product elements to page</p>
                <p>‚úÖ Now test detection again to see if widget appears</p>
                <p><button class="test-button" onclick="testDetection()">Test Detection Again</button></p>
            `;
        }
        
        // Auto-run basic check on page load
        window.addEventListener('load', function() {
            console.log('üêõ Debug page loaded - checking basic detection status');
            
            // Check if we're on a fashion-related domain
            const hostname = window.location.hostname.toLowerCase();
            const fashionDomains = ['fashion', 'style', 'clothing', 'apparel', 'shop', 'store', 'boutique'];
            const isFashionDomain = fashionDomains.some(domain => hostname.includes(domain));
            
            if (isFashionDomain) {
                document.getElementById('detection-status').className = 'status success';
                document.getElementById('detection-status').textContent = '‚úÖ Current page appears to be fashion-related';
            }
        });
    </script>
</body>
</html>
